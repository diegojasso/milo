<!DOCTYPE html>
<html>
<head>
    <title>Mapa {{ title }}</title>
    <script src="/javascripts/jquery-2.1.1.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
    <link rel="stylesheet" href="/stylesheets/foundation.css" />

	<link rel="stylesheet" href='/stylesheets/font-awesome.min.css'>

    <link rel='stylesheet' href='/stylesheets/style.css' />

    <script src="/javascripts/d3.v3.min.js"></script>
    <script src="/javascripts/topojson.v1.min.js"></script>
    <script src="/javascripts/datamaps.world.min.js"></script>

    <script>



        var socket = io.connect();

        socket.on('connect', function() {
            console.log('Conectado - página 1!');
        });

        socket.on('message', function(message){

            // console.log(message);

            if ((message.indexOf('"canal_mensaje":"pademobile_log_total"') == -1) &&
                (message.indexOf('"canal_mensaje":"pademobile_log_transaccion"') == -1)) {
                return 0;
            }

            var datos = JSON.parse(message);

            var pais = '{{ pais }}'.toUpperCase();

            switch(datos.canal_mensaje) {
                case 'pademobile_log_transaccion' :

                    break;
            }
        }) ;

        socket.on('disconnect', function() {
            console.log('disconnected');
            // content.html("<b>Disconnected!</b>");
        });


        $(document).ready(function() {
            var socket = io.connect();
            var content = $('#filas');

            var fechaactual = null;

            socket.on('connect', function() {
                console.log('Conectado - página 1!');
            });

            socket.on('message', function(message){
                var datos = JSON.parse(message);
                console.log(datos);
            }) ;

            var transactions = [{
                name: 'Joe 4',
                radius: 25,
                yeild: 400,
                country: 'USSR',
                fillKey: 'PDM',
                significance: 'First fusion weapon test by the USSR (not "staged")',
                date: '1953-08-12',
                latitude: 80.07,
                longitude: 98.43
            },{
                name: 'RDS-37',
                radius: 40,
                yeild: 1600,
                country: 'USSR',
                fillKey: 'PDM',
                significance: 'First "staged" thermonuclear weapon test by the USSR (deployable)',
                date: '1955-11-22',
                latitude: 50.07,
                longitude: 78.43

            },{
                name: 'Tsar Bomba',
                radius: 75,
                yeild: 50000,
                country: 'USSR',
                fillKey: 'PDM',
                significance: 'Largest thermonuclear weapon ever tested—scaled down from its initial 100 Mt design by 50%',
                date: '1961-10-31',
                latitude: 73.482,
                longitude: 54.5854
            },{
                name: 'Tsar',
                radius: 50,
                yeild: 50000,
                country: 'USA',
                fillKey: 'PDM',
                significance: 'Largest thermonuclear weapon ever tested—scaled down from its initial 100 Mt design by 50%',
                date: '1961-10-31',
                latitude: 33.88,
                longitude: -77.01
            }
            ];
            //draw bubbles for transactions :)
            map.bubbles(transactions, {
                popupTemplate: function (geo, data) {
                    return ['<div class="hoverinfo">' +  data.name,
                                '<br/>Payload: ' +  data.yeild + ' kilotons',
                                '<br/>Country: ' +  data.country + '',
                                '<br/>Date: ' +  data.date + '',
                        '</div>'].join('');
                },
                borderWidth: 0,
                highlightBorderWidth: 0

            });
        });
    </script>
</head>

<body>
    <div id="mapContainer" class="mapView"></div>

    <div class="bottomLine marquee">
        <div>
        <section>
            <span class="barTitle">Transactions</span>
            <span class="barElement">MEX 12,181 <span class="greenSign fa fa-arrow-up"></span></span>
            <span class="barElement">ESP 1,238 <span class="redSign fa fa-arrow-down"></span></span>
            <span class="barElement">USA 902 <span class="greenSign fa fa-arrow-up"></span></span>
            <span class="barElement">ITA 902 <span class="greenSign fa fa-arrow-up"></span></span>

            <span class="barTitle">Top Users MEX</span>
            <span class="barElement">dgsalas</span>
            <span class="barElement">diego_</span>
            <span class="barElement">4492019221</span>

            <span class="barTitle">Top Users USA</span>
            <span class="barElement">1331292828</span>
            <span class="barElement">1291822384</span>
            <span class="barElement">1492019221</span>

        </section>

        <section>
            <span class="barTitle">Transactions</span>
            <span class="barElement">MEX 12,181 <span class="greenSign fa fa-arrow-up"></span></span>
            <span class="barElement">ESP 1,238 <span class="redSign fa fa-arrow-down"></span></span>
            <span class="barElement">USA 902 <span class="greenSign fa fa-arrow-up"></span></span>
            <span class="barElement">ITA 902 <span class="greenSign fa fa-arrow-up"></span></span>

            <span class="barTitle">Top Users MEX</span>
            <span class="barElement">dgsalas</span>
            <span class="barElement">diego_</span>
            <span class="barElement">4492019221</span>

            <span class="barTitle">Top Users USA</span>
            <span class="barElement">1331292828</span>
            <span class="barElement">1291822384</span>
            <span class="barElement">1492019221</span>

        </section>

        </div>
    </div>

    <img class="poweredby" src="images/poweredby.svg">
</body>